function addInput(t,e,o){var n=document.createElement("div");n.setAttribute("id","subtopic-div-"+counter_subtopics),n.innerHTML='<label class="control-label col-sm-2" for="inputLarge"></label><div class="col-sm-8"><input type="hidden" name="subtopic_pk[]" id="subtopic-pk-'+counter_subtopics+'" value="'+o+'"><input class="form-control input-sm" type="text" name="subtopic[]" id="subtopic-'+counter_subtopics+'" value="'+e+'"></div><div class="col-sm-2"><span class="input-group-btn"><button class="btn btn-primary btn-material-'+session_color+'-800 btn-sm" type="button" onclick="deleteInput(\'subtopic-div-'+counter_subtopics+"')\">Delete</button></span></div>",document.getElementById(t).appendChild(n),counter_subtopics++}function deleteInput(t){document.getElementById(t).remove()}function deleteSubtopics(t){for(var e=1+t;counter_subtopics>e;)0!=$("#subtopic-div-"+e).length&&deleteInput("subtopic-div-"+e),e++}function submit_committee(){var t=1,e=1,o=[];for(console.log("create post is working!"),console.log($("#id_pk").val()),console.log($("#id_name").val()),console.log($("#id_topic").val());counter_subtopics>=t;)void 0!=$("#subtopic-"+t).val()&&(console.log($("#subtopic-"+t).val()),o.push({pk:$("#subtopic-pk-"+t).val(),subtopic:$("#subtopic-"+t).val()})),t++;console.log(o),$.ajax({url:committee_post_url,type:"POST",data:{pk:$("#id_pk").val(),name:$("#id_name").val(),topic:$("#id_topic").val(),subtopics:JSON.stringify(o)},success:function(t){""!=$("#id_pk").val()&&deleteInput("committee-row-"+t.pk);var o=table.insertRow(0),n=o.insertCell(0),i=o.insertCell(1),s=o.insertCell(2),c=o.insertCell(3),l=o.insertCell(4);for($(o).attr("id","committee-row-"+t.pk),n.innerHTML=t.pk,i.innerHTML=$("#id_name").val(),s.innerHTML=$("#id_topic").val(),c.innerHTML=t.subtopics,l.innerHTML='<a href="javascript:void(0)" class="btn btn-primary btn-material-'+session_color+'-800 btn-xs" onclick="editCommittee(\''+t.pk+'\')" ><span class="mdi-content-create" style="font-size: 10px; margin-right: 4px;"></span>Edit</a><a href="javascript:void(0)" class="btn btn-primary btn-danger btn-xs" onclick="deleteCommittee(\''+t.pk+"')\" >Delete</a>",$(o).css("display","none"),$(o).fadeIn("slow"),$("#id_pk").val(""),$("#id_name").val(""),$("#id_topic").val("");counter_subtopics>=e;)void 0!=$("#subtopic-"+e).val()&&($("#subtopic-"+e).val(""),$("#subtopic-pk-"+e).val("")),e++;deleteSubtopics(1),$("#subtopic-1").val("General"),counter_subtopics=3,console.log(t),console.log("success")},error:function(t,e,o){console.log(t.status+": "+t.responseText)}})}function editCommittee(t){$.ajax({url:committees_api_url,data:"pk="+t,success:function(t){console.log("ajax success for: "+t.name),$("#id_pk").val(t.pk),$("#id_name").val(t.name),$("#id_topic").val(t.topic),deleteSubtopics(0),t.subtopics.forEach(function(t){"General"!=t.subtopic&&addInput("add_subtopics",t.subtopic,t.pk)})},cache:!1})}function deleteCommittee(t){return console.log("lets delete "+t),1!=confirm("Are you sure you want to delete this committee?")?!1:(console.log(csrftoken),void $.ajax({url:committee_post_url,type:"DELETE",data:{pk:t},success:function(e){deleteInput("committee-row-"+t),console.log("post deletion successful")},error:function(t,e,o){console.log(t.status+": "+t.responseText)}}))}function getCookie(t){var e=null;if(document.cookie&&""!=document.cookie)for(var o=document.cookie.split(";"),n=0;n<o.length;n++){var i=jQuery.trim(o[n]);if(i.substring(0,t.length+1)==t+"="){e=decodeURIComponent(i.substring(t.length+1));break}}return e}function csrfSafeMethod(t){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(t)}function sameOrigin(t){var e=document.location.host,o=document.location.protocol,n="//"+e,i=o+n;return t==i||t.slice(0,i.length+1)==i+"/"||t==n||t.slice(0,n.length+1)==n+"/"||!/^(\/\/|http:|https:).*/.test(t)}var counter_subtopics=3,limit_subtopics=30,table=document.getElementById("committees-table").getElementsByTagName("tbody")[0];Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var t=this.length-1;t>=0;t--)this[t]&&this[t].parentElement&&this[t].parentElement.removeChild(this[t])},$("#committee-form").on("submit",function(t){t.preventDefault(),console.log("form submitted!"),submit_committee()});var csrftoken=getCookie("csrftoken");$.ajaxSetup({beforeSend:function(t,e){!csrfSafeMethod(e.type)&&sameOrigin(e.url)&&t.setRequestHeader("X-CSRFToken",csrftoken)}});