function deleteInput(t){document.getElementById(t).remove()}function requestData(t,e,n){$.ajax({url:data_url,data:"data_type="+t+"&offset="+e+"&count="+n,success:function(e){"point"===t?("undefined"!=typeof e.datapoints[0].pk&&(latest_point_pk=e.datapoints[0].pk),total_point=e.totaldata,offset_point+=n,"undefined"!=typeof e.datapoints[0].committee_by&&e.datapoints.forEach(function(t){createPoint(t.pk,t.last_changed,t.committee_by,t.active_debate,t.round_no,t.point_type,t.subtopics,t.committee_color,t.committee_text_color)})):"content"===t?("undefined"!=typeof e.datapoints[0].pk&&(latest_content_pk=e.datapoints[0].pk),total_content=e.totaldata,offset_content+=n,"undefined"!=typeof e.datapoints[0].content&&e.datapoints.forEach(function(t){createContent(t.pk,t.last_changed,t.committee_by,t.active_debate,t.content,t.point_type,t.committee_color,t.committee_text_color)})):"vote"===t&&("undefined"!=typeof e.datapoints[0].pk&&(latest_vote_pk=e.datapoints[0].pk),total_vote=e.totaldata,offset_vote+=n,"undefined"!=typeof e.datapoints[0].committee_by&&e.datapoints.forEach(function(t){createVote(t.pk,t.last_changed,t.committee_by,t.active_debate,t.in_favour,t.against,t.abstentions,t.absent,t.committee_color,t.committee_text_color)}))},cache:!1})}function createPoint(t,e,n,o,a,i,l,s,d){var c=document.getElementById("point-table").getElementsByTagName("tbody")[0],r=c.insertRow(0),p=r.insertCell(0),_=r.insertCell(1),m=r.insertCell(2),u=r.insertCell(3),v=r.insertCell(4),b=r.insertCell(5),f=r.insertCell(6),g=r.insertCell(7);$(r).attr("id","point-"+t),$(r).css("display","none"),p.innerHTML=t,_.innerHTML=e,m.innerHTML=n,u.innerHTML=o,v.innerHTML=a,"P"===i?b.innerHTML='<img src="'+point_img+'" height="30" >':b.innerHTML='<img src="'+dr_img+'" height="30" >',f.innerHTML=l,g.innerHTML='<a href="javascript:void(0)" class="btn btn-xs btn-material-'+session_color+'-800 btn-fab btn-raised mdi-content-create" data-toggle="modal" data-target="#edit-point" onclick="editPoint(\''+t+'\')" ></a><a href="javascript:void(0)" class="btn btn-danger btn-fab btn-raised mdi-action-delete" onclick="" ></a>',$(m).addClass("label-material-"+s+"-400"),$(m).css("color",d),$(r).fadeIn("slow")}function createContent(t,e,n,o,a,i,l,s){var d=document.getElementById("content-table").getElementsByTagName("tbody")[0],c=d.insertRow(0),r=c.insertCell(0),p=c.insertCell(1),_=c.insertCell(2),m=c.insertCell(3),u=c.insertCell(4),v=c.insertCell(5),b=c.insertCell(6);$(c).attr("id","content-"+t),$(c).css("display","none"),r.innerHTML=t,p.innerHTML=e,_.innerHTML=n,m.innerHTML=o,u.innerHTML=a,"P"===i?v.innerHTML='<img src="'+point_img+'" height="30" >':v.innerHTML='<img src="'+dr_img+'" height="30" >',b.innerHTML='<a href="javascript:void(0)" class="btn btn-xs btn-material-'+session_color+'-800 btn-fab btn-raised mdi-content-create" data-toggle="modal" data-target="#edit-content" onclick="editContent(\''+t+'\')" ></a><a href="javascript:void(0)" class="btn btn-danger btn-fab btn-raised mdi-action-delete" onclick="" ></a>',$(_).addClass("label-material-"+l+"-400"),$(_).css("color",s),$(c).fadeIn("slow")}function createVote(t,e,n,o,a,i,l,s,d,c){var r=document.getElementById("vote-table").getElementsByTagName("tbody")[0],p=r.insertRow(0),_=p.insertCell(0),m=p.insertCell(1),u=p.insertCell(2),v=p.insertCell(3),b=p.insertCell(4),f=p.insertCell(5),g=p.insertCell(6),y=p.insertCell(7);vote_action=p.insertCell(8),$(p).attr("id","vote-"+t),$(p).css("display","none"),_.innerHTML=t,m.innerHTML=e,u.innerHTML=n,v.innerHTML=o,b.innerHTML=a,f.innerHTML=i,g.innerHTML=l,y.innerHTML=s,vote_action.innerHTML='<a href="javascript:void(0)" class="btn btn-xs btn-material-'+session_color+'-800 btn-fab btn-raised mdi-content-create" data-toggle="modal" data-target="#edit-vote" onclick="editVote(\''+t+'\')" ></a><a href="javascript:void(0)" class="btn btn-danger btn-fab btn-raised mdi-action-delete" onclick="" ></a>',$(u).addClass("label-material-"+d+"-400"),$(u).css("color",c),$(p).fadeIn("slow")}function editPoint(t){var e="data_type=point&pk="+t;$.ajax({url:data_pk_url,data:e,success:function(t){$("#point_id_pk").val(t.pk),document.getElementById("point_id_committee").options.namedItem(t.committee_by).selected=!0,document.getElementById("point_id_debate").options.namedItem(t.active_debate).selected=!0,document.getElementById("point_id_round_no").options.namedItem(t.round_no).selected=!0,document.getElementById("point_id_point_type").options.namedItem(t.point_type).selected=!0;for(var e=document.getElementById("point_id_subtopics"),n=0;e.options.length>0;)e.options.remove(0);all_subtopics=[],t.all_subtopics.forEach(function(t){all_subtopics.push(t.subtopic);var o=document.createElement("option");o.text=t.subtopic,$(o).attr("id",t.pk),e.options.add(o,n),n++}),console.log(all_subtopics),t.subtopics.forEach(function(t){e.options.namedItem(t.pk).selected=!0})},cache:!1})}function editContent(t){var e="data_type=content&pk="+t;$.ajax({url:data_pk_url,data:e,success:function(t){$("#content_id_pk").val(t.pk),$("#content_id_content").val(t.content),document.getElementById("content_id_committee").options.namedItem(t.committee_by).selected=!0,document.getElementById("content_id_debate").options.namedItem(t.active_debate).selected=!0,document.getElementById("content_id_point_type").options.namedItem(t.point_type).selected=!0},cache:!1})}function editVote(t){var e="data_type=vote&pk="+t;$.ajax({url:data_pk_url,data:e,success:function(t){$("#vote_id_pk").val(t.pk),$("#vote_id_in_favour").val(t.in_favour),$("#vote_id_against").val(t.against),$("#vote_id_abstentions").val(t.abstentions),$("#vote_id_absent").val(t.absent),document.getElementById("vote_id_committee").options.namedItem(t.committee_by).selected=!0,document.getElementById("vote_id_debate").options.namedItem(t.active_debate).selected=!0,getTotal()},cache:!1})}function getTotal(){var t=$("#vote_id_in_favour"),e=$("#vote_id_against"),n=$("#vote_id_abstentions"),o=$("#vote_id_absent");total=parseInt(t.val())+parseInt(e.val())+parseInt(n.val())+parseInt(o.val()),$("#vote-total").html(total)}function savePoint(){console.log($("#point_id_pk").val()),console.log($("#point_id_committee").val()),console.log($("#point_id_debate").val()),console.log($("#point_id_round_no").val()),console.log($("#point_id_point_type").val()),console.log($("#point_id_subtopics").val()),$.ajax({url:data_pk_url,type:"POST",data:{"data-type":"point",pk:$("#point_id_pk").val(),committee:$("#point_id_committee").val(),debate:$("#point_id_debate").val(),round_no:$("#point_id_pk").val(),point_type:$("#point_id_point_type").val(),subtopics:$("#point_id_subtopics").val(),all_subtopics:all_subtopics},success:function(t){deleteInput("point-"+$("#point_id_pk").val()),createPoint(pk,last_changed,by,on,round,type,subtopics,color,text_color)},cache:!1})}var offset_point=0,offset_content=0,total_point,total_content,total_points_displayed=0,total_content_displayed=0,latest_point_pk=0,latest_content_pk=0,offset_vote=0,total_vote,total_votes_displayed=0,latest_vote_pk=0,all_subtopics;Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var t=this.length-1;t>=0;t--)this[t]&&this[t].parentElement&&this[t].parentElement.removeChild(this[t])},$("input").keyup(getTotal),$(document).ready(getTotal),$("#point-form").on("submit",function(t){t.preventDefault(),console.log("Point form submitted!"),savePoint()}),$("#content-form").on("submit",function(t){t.preventDefault(),console.log("Content form submitted!"),savePoint()}),$("#vote-form").on("submit",function(t){t.preventDefault(),console.log("Vote form submitted!"),savePoint()}),requestData("point",0,10),requestData("content",0,10),requestData("vote",0,10);